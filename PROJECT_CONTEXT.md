# Dota Mini App - –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞

## üéØ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

Telegram Mini App –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ –∏ –≥–µ—Ä–æ–µ–≤ –≤ Dota 2 –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–≤–∏–∑–æ–≤.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
1. **Position Quiz** ‚Äî –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â—É—é –∏–≥—Ä–æ–≤—É—é –ø–æ–∑–∏—Ü–∏—é (–∫–µ—Ä—Ä–∏, –º–∏–¥, –æ—Ñ—Ñ–ª–µ–π–Ω, —Ä–æ—É–º–µ—Ä, —Å–∞–ø–ø–æ—Ä—Ç)
2. **Hero Quiz** ‚Äî –ø–æ–¥–±–∏—Ä–∞–µ—Ç —Ç–æ–ø-5 –≥–µ—Ä–æ–µ–≤ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ —Å –ø—Ä–æ—Ü–µ–Ω—Ç–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
3. **–ü—Ä–æ—Ñ–∏–ª—å** ‚Äî –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω—é—é –ø–æ–∑–∏—Ü–∏—é –∏ –≥–µ—Ä–æ–µ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Telegram** ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –±–æ—Ç–∞, –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è

### –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è:
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è OpenDota API –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏–≥—Ä–æ–∫–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Stratz API –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –º–∞—Ç—á–µ–π (—Ç—Ä–µ–±—É–µ—Ç—Å—è API –∫–ª—é—á —Å –æ—Å–æ–±—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏)
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏–≥—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- **Frontend**: SPA –Ω–∞ —á–∏—Å—Ç–æ–º HTML/CSS/JS (Vanilla JavaScript)
- **Backend**: Python, FastAPI (Uvicorn), –ø–æ—Ä—Ç 8000
- **–ë–î**: SQLite (`backend/dota_bot.db`)
- **Telegram Bot**: aiogram (polling)
- **–í–µ–±-—Å–µ—Ä–≤–µ—Ä**: nginx + Let's Encrypt (HTTPS)
- **–î–æ–º–µ–Ω**: dotaquiz.blog (Porkbun, A-–∑–∞–ø–∏—Å–∏ –Ω–∞ VPS)

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **VPS**: Contabo, Ubuntu
- **IP**: 62.171.144.53
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: zafer
- **–ü—É—Ç—å**: /home/zafer/dota-mini-app
- **Python**: venv –≤ /home/zafer/dota-mini-app/venv

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
dota-mini-app/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ api.py              # FastAPI —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ bot.py              # Telegram bot (aiogram)
‚îÇ   ‚îú‚îÄ‚îÄ db.py               # –†–∞–±–æ—Ç–∞ —Å SQLite
‚îÇ   ‚îî‚îÄ‚îÄ dota_bot.db         # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îú
‚îÇ‚îÄ‚îÄscript.js           # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ‚îÄ‚îÄstyles.css          # –°—Ç–∏–ª–∏
‚îÇ # –î–∞–Ω–Ω—ã–µ –≥–µ—Ä–æ–µ–≤ –ø–æ –ø–æ–∑–∏—Ü–∏—è–º
‚îÇ‚îÄ‚îÄheroes-carry.js
‚îÇ‚îÄ‚îÄheroes-mid.js
‚îÇ‚îÄ‚îÄheroes-offlane.js
‚îÇ‚îÄ‚îÄheroes-pos45.js  # –û–±—â–∏–π –¥–ª—è —Ä–æ—É–º–µ—Ä–∞ –∏ —Å–∞–ø–ø–æ—Ä—Ç–∞
‚îÇ‚îÄ‚îÄindex.html          # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (SPA)
‚îÇ
‚îú‚îÄ‚îÄ venv/                   # Python virtual environment
‚îú‚îÄ‚îÄ .env                    # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–µ –≤ git)
‚îú‚îÄ‚îÄ .gitignore
‚îî‚îÄ‚îÄ PROJECT_CONTEXT.md      # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

---

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã

#### user_profiles
```sql
CREATE TABLE user_profiles (
    user_id INTEGER PRIMARY KEY,
    favorite_heroes JSON,  -- ["Hero1", "Hero2", ...]
    settings JSON          -- {username, first_name, last_name, photo_url}
);
```

#### quiz_results
```sql
CREATE TABLE quiz_results (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER,
    result JSON NOT NULL,  -- –°–º. —Å—Ç—Ä—É–∫—Ç—É—Ä—É –Ω–∏–∂–µ
    updated_at DATETIME,
    FOREIGN KEY(user_id) REFERENCES user_profiles(user_id)
);
```

#### tokens
```sql
CREATE TABLE tokens (
    token TEXT PRIMARY KEY,
    user_id INTEGER NOT NULL,
    expires_at TEXT NOT NULL
);
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ result (JSON –≤ quiz_results)

**–ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç** (–ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è):
```json
{
  "position_quiz": {
    "type": "position_quiz",
    "position": "Pos 1 ‚Äî –ö–µ—Ä—Ä–∏",
    "posShort": "–ö–µ—Ä—Ä–∏",
    "positionIndex": 0,
    "date": "18.02.2026",
    "isPure": false,
    "extraPos": "pos2"
  },
  "hero_quiz_by_position": {
    "0": {
      "type": "hero_quiz",
      "heroPositionIndex": 0,
      "topHeroes": [
        {"name": "Anti-Mage", "score": 8.5, "matchPercent": 95},
        {"name": "Juggernaut", "score": 7.2, "matchPercent": 82},
        ...
      ]
    },
    "2": {
      "type": "hero_quiz",
      "heroPositionIndex": 2,
      "topHeroes": [...]
    }
  }
}
```

**–°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç** (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å):
```json
{
  "type": "position_quiz",
  "position": "Pos 1 ‚Äî –ö–µ—Ä—Ä–∏",
  "positionIndex": 0,
  "hero_quiz": {
    "type": "hero_quiz",
    "heroPositionIndex": 0,
    "topHeroes": [...]
  }
}
```

---

## üéÆ –ò–Ω–¥–µ–∫—Å—ã –ø–æ–∑–∏—Ü–∏–π

| –ü–æ–∑–∏—Ü–∏—è | –ù–∞–∑–≤–∞–Ω–∏–µ –≤ –∏–≥—Ä–µ | mainPos | positionIndex | heroPositionIndex |
|---------|----------------|---------|---------------|-------------------|
| Pos 1 | –ö–µ—Ä—Ä–∏ (Carry) | pos1 | 0 | 0 |
| Pos 2 | –ú–∏–¥ (Mid) | pos2 | 1 | 1 |
| Pos 3 | –û—Ñ—Ñ–ª–µ–π–Ω (Offlane) | pos3 | 2 | 2 |
| Pos 4 | –†–æ—É–º–µ—Ä (Roamer) | pos4 | 3 | 3 |
| Pos 5 | –°–∞–ø–ø–æ—Ä—Ç (Support) | pos5 | 4 | 4 |

**–í–∞–∂–Ω–æ**: 
- `positionIndex` —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ `parseInt(mainPos.replace('pos', '')) - 1`
- –ü–æ–∑–∏—Ü–∏–∏ 4 –∏ 5 –∏—Å–ø–æ–ª—å–∑—É—é—Ç **–æ–±—â–∏–π —Ñ–∞–π–ª** `heroes-pos45.js` —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º —Å–ø–∏—Å–∫–æ–º –≥–µ—Ä–æ–µ–≤

---

## üîå API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### POST /api/save_result
–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–≤–∏–∑–∞ (–ø–æ–∑–∏—Ü–∏–∏ –∏–ª–∏ –≥–µ—Ä–æ–µ–≤).

**Request:**
```json
{
  "token": "abc123xyz",
  "result": {
    "type": "position_quiz" | "hero_quiz",
    "positionIndex": 0,
    "heroPositionIndex": 0,
    "topHeroes": [...]
  }
}
```

**Response:** `{"success": true}`

### GET /api/profile_full?token=...
–ü–æ–ª–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∏—Å—Ç–æ—Ä–∏–µ–π –∫–≤–∏–∑–æ–≤.

**Response:**
```json
{
  "user_id": 556944111,
  "username": "username",
  "first_name": "–ò–≤–∞–Ω",
  "photo_url": "https://...",
  "total_quizzes": 5,
  "last_quiz_date": "2026-02-18T10:30:00",
  "quiz_history": [
    {
      "date": "2026-02-18T10:30:00",
      "result": {
        "position_quiz": {...},
        "hero_quiz_by_position": {...}
      }
    }
  ]
}
```

### GET /api/get_result?token=...
–¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–≤–∏–∑–∞.

**Response:** `{"result": {...}}` –∏–ª–∏ `{"result": null}`

### POST /api/check-subscription
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ –∫–∞–Ω–∞–ª.

### POST /api/save_telegram_data
–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è –∏–∑ Telegram (–∏–º—è, username, —Ñ–æ—Ç–æ).

---

## ü§ñ Telegram Bot

### –ö–æ–º–∞–Ω–¥—ã
- `/start` ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É, –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Mini App
- `/help` ‚Äî —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –ü—Ä–æ—Ü–µ—Å—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç `/start`
2. –ë–æ—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ –∫–∞–Ω–∞–ª (CHECK_CHAT_ID: -1001982934939)
3. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ `create_token_for_user(user_id)`
4. –¢–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ URL: `https://dotaquiz.blog/?token=abc123xyz`
5. Frontend –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–æ–∫–µ–Ω –∏–∑ URL: `const USER_TOKEN = getTokenFromUrl()`
6. –¢–æ–∫–µ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ –≤—Å–µ—Ö API –∑–∞–ø—Ä–æ—Å–∞—Ö

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **BOT_TOKEN**: 
- **MINI_APP_URL**: https://dotaquiz.blog/
- **CHECK_CHAT_ID**: -1001982934939 (–∫–∞–Ω–∞–ª @kasumi_tt)
- **–†–µ–∂–∏–º**: Polling (–Ω–µ webhook)

---

## üöÄ Deployment

### SSH –¥–æ—Å—Ç—É–ø
```bash
ssh zafer@62.171.144.53
cd ~/dota-mini-app
```

### –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è
```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh zafer@62.171.144.53

# 2. –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ–µ–∫—Ç
cd ~/dota-mini-app

# 3. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥
git pull

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
sudo systemctl restart dota-api.service
sudo systemctl restart dota-bot.service

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status dota-api.service
sudo systemctl status dota-bot.service
```

### Systemd Services

#### dota-api.service
```ini
[Unit]
Description=Dota Mini App FastAPI backend
After=network.target

[Service]
User=zafer
WorkingDirectory=/home/zafer/dota-mini-app
Environment="BOT_TOKEN=8576767518:AAFeAqIesgJX4V67WX8H_MbmcG334PMUsdE"
Environment="CHECK_CHAT_ID=-1001982934939"
ExecStart=/home/zafer/dota-mini-app/venv/bin/python -m uvicorn backend.api:app --host 0.0.0.0 --port 8000 --log-level debug
Restart=always
RestartSec=5

[Install]
WantedBy=multi-user.target
```

#### dota-bot.service
```ini
[Unit]
Description=Dota Telegram Bot
After=network.target

[Service]
User=zafer
WorkingDirectory=/home/zafer/dota-mini-app/backend
Environment="BOT_TOKEN=8576767518:AAFeAqIesgJX4V67WX8H_MbmcG334PMUsdE"
Environment="MINI_APP_URL=https://dotaquiz.blog/"
Environment="CHECK_CHAT_ID=-1001982934939"
ExecStart=/home/zafer/dota-mini-app/venv/bin/python /home/zafer/dota-mini-app/backend/bot.py
Restart=always
RestartSec=5

[Install]
WantedBy=multi-user.target
```

### Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
**–§–∞–π–ª**: `/etc/nginx/sites-available/default`

```nginx
server {
    root /home/zafer/dota-mini-app;
    index index.html index.htm;
    server_name dotaquiz.blog www.dotaquiz.blog;

    # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –∏ –º–∏–Ω–∏-–∞–ø–ø
    location / {
        try_files $uri $uri/ /index.html;
    }

    # –ü—Ä–æ–∫—Å–∏ –Ω–∞ FastAPI (uvicorn backend.api:app –Ω–∞ 8000 –ø–æ—Ä—Ç—É)
    location /api/ {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    listen [::]:443 ssl ipv6only=on; # managed by Certbot
    listen 443 ssl; # managed by Certbot
    ssl_certificate /etc/letsencrypt/live/dotaquiz.blog/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/dotaquiz.blog/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;
}

server {
    if ($host = www.dotaquiz.blog) {
        return 301 https://$host$request_uri;
    }
    
    if ($host = dotaquiz.blog) {
        return 301 https://$host$request_uri;
    }

    listen 80 default_server;
    listen [::]:80 default_server;
    server_name dotaquiz.blog www.dotaquiz.blog;
    return 404;
}
```

---

## üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
–§–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (–Ω–µ –≤ git, –Ω–∞—Å—Ç—Ä–æ–µ–Ω `.gitignore`):
```env
BOT_TOKEN=8576767518:AAFeAqIesgJX4V67WX8H_MbmcG334PMUsdE
MINI_APP_URL=https://dotaquiz.blog/
CHECK_CHAT_ID=-1001982934939
```

### –ü—Ä–æ–¥–∞–∫—à–Ω
–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ–ø–∏—Å–∞–Ω—ã –Ω–∞–ø—Ä—è–º—É—é –≤ systemd services (—Å–º. —Å–µ–∫—Ü–∏—é Deployment).

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: `.env` —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –Ω–æ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ `Environment=` –≤ systemd –∫–æ–Ω—Ñ–∏–≥–∞—Ö.

---

## üõ†Ô∏è –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î
sqlite3 /home/zafer/dota-mini-app/backend/dota_bot.db

# –í–Ω—É—Ç—Ä–∏ sqlite:
.tables                                          # –°–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü
.schema quiz_results                            # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã
.mode line                                      # –£–¥–æ–±–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
SELECT * FROM quiz_results WHERE user_id = 556944111;
.quit
```

### –õ–æ–≥–∏
```bash
# –õ–æ–≥–∏ FastAPI
sudo journalctl -u dota-api.service -f

# –õ–æ–≥–∏ –±–æ—Ç–∞
sudo journalctl -u dota-bot.service -f

# –õ–æ–≥–∏ nginx
sudo tail -f /var/log/nginx/access.log
sudo tail -f /var/log/nginx/error.log
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏
```bash
sudo systemctl status dota-api.service
sudo systemctl restart dota-api.service
sudo systemctl stop dota-api.service

sudo systemctl status dota-bot.service
sudo systemctl restart dota-bot.service

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ nginx
sudo systemctl reload nginx
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
```bash
# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
source /home/zafer/dota-mini-app/venv/bin/activate

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ requirements.txt –æ–±–Ω–æ–≤–ª—ë–Ω)
pip install -r backend/requirements.txt

# –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
# - fastapi
# - uvicorn
# - aiogram
# - sqlite3 (–≤—Å—Ç—Ä–æ–µ–Ω –≤ Python)
```

---

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ì–µ—Ä–æ–∏ –Ω–µ –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ –ø—Ä–æ—Ñ–∏–ª–µ
**–°–∏–º–ø—Ç–æ–º—ã**: –ü–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è hero_quiz –≥–µ—Ä–æ–∏ –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ –±–ª–æ–∫–µ "–¢–≤–æ–∏ –≥–µ—Ä–æ–∏". –ü—Ä–æ–±–ª–µ–º–∞ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏, –Ω–µ —Å–≤—è–∑–∞–Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ —Å –ø–æ–∑–∏—Ü–∏—è–º–∏ 4-5.

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
- `hero_quiz_by_position[positionIndex]` –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏
- –ù–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –º–µ–∂–¥—É `position_quiz` –∏ `hero_quiz`
- –î–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ –±—ç–∫–µ–Ω–¥–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ü—Ä–æ–±–ª–µ–º–∞ –≤ –ª–æ–≥–∏–∫–µ –∑–∞–ø–∏—Å–∏/—á—Ç–µ–Ω–∏—è –∏–∑ –ë–î

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**:
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –ë–î
SELECT result FROM quiz_results WHERE user_id = 556944111;
```

**–°—Ç–∞—Ç—É—Å**: –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å debug-–ª–æ–≥–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Å—å –ø—É—Ç—å: Frontend ‚Üí Backend ‚Üí –ë–î ‚Üí Frontend.

### 2. –°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ (hero_quiz vs hero_quiz_by_position)
**–ü—Ä–æ–±–ª–µ–º–∞**: –í –ë–î –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–ø–∏—Å–∏ —Å—Ç–∞—Ä–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –±–µ–∑ `hero_quiz_by_position`. –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –ø—Ä–æ–≤–æ–¥–∏–ª–∞—Å—å, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.

**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å fallback –≤–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ:
```javascript
// –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç
if (res.hero_quiz_by_position && res.hero_quiz_by_position[positionIndex]) {
    heroData = res.hero_quiz_by_position[positionIndex];
}
// Fallback –Ω–∞ —Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç
else if (res.hero_quiz && res.hero_quiz.heroPositionIndex === positionIndex) {
    heroData = res.hero_quiz;
}
```

**–°—Ç–∞—Ç—É—Å**: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ. –ú–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–¥—Å—Ç—Ä–∞—Ö–æ–≤–∫–∏.

### 3. DNS —Å–µ—Ä–≤–µ—Ä
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ—à–µ–Ω–æ. –ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–∞—è, –±–æ–ª—å—à–µ –Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è.

### 4. –ö–∞—Ä—Ç–∏–Ω–∫–∏ –≥–µ—Ä–æ–µ–≤
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ—à–µ–Ω–æ. –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

---

## üìä –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

- **–û—Å–Ω–æ–≤–Ω–æ–π user_id**: 556944111
- **–¢–µ—Å—Ç–æ–≤—ã–π –∫–∞–Ω–∞–ª**: @dota2_quiz_blog (ID: -1001982934939)
- **–ü–æ–∑–∏—Ü–∏–∏**: –¢–µ—Å—Ç–∏—Ä—É—é—Ç—Å—è –≤—Å–µ (–∫–µ—Ä—Ä–∏, –º–∏–¥, –æ—Ñ—Ñ–ª–µ–π–Ω, —Ä–æ—É–º–µ—Ä, —Å–∞–ø–ø–æ—Ä—Ç)
- **–î—Ä—É–≥–∏—Ö —Ç–µ—Å—Ç–æ–≤—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –Ω–µ—Ç** ‚Äî –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–æ–¥—è—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–º –∞–∫–∫–∞—É–Ω—Ç–µ

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **GitHub**: https://github.com/ilya13qwertyuiop-droid/dota-mini-app
- **–î–æ–º–µ–Ω**: https://dotaquiz.blog
- **Dota 2 Pro Tracker**: https://www.dota2protracker.com/hero/{hero_name}
- **OpenDota API**: https://docs.opendota.com/
- **Stratz API**: https://stratz.com/api (—Ç—Ä–µ–±—É–µ—Ç—Å—è –æ—Å–æ–±—ã–π API –∫–ª—é—á)

---

## üéØ –î–ª—è –Ω–æ–≤–æ–≥–æ —Ç—Ä–µ–¥–∞ —Å AI-–ø–æ–º–æ—â–Ω–∏–∫–æ–º

–°–∫–æ–ø–∏—Ä—É–π —ç—Ç–æ –≤ –Ω–æ–≤—ã–π —Ç—Ä–µ–¥ —Å Perplexity/Claude:

```
–ü—Ä–æ–µ–∫—Ç: Dota Mini App (Telegram WebApp –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ –≥–µ—Ä–æ–µ–≤ Dota 2)
Repo: github.com/ilya13qwertyuiop-droid/dota-mini-app
Stack: FastAPI + SQLite + Vanilla JS + aiogram
–°–µ—Ä–≤–µ—Ä: zafer@62.171.144.53, ~/dota-mini-app
User ID: 556944111

–ò–∑—É—á–∏ PROJECT_CONTEXT.md –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ –ø–æ–º–æ–≥–∏ —Å [–æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã].
```

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 18.02.2026, 16:12 +03:00