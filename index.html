<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Dota 2 Helper</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta
    name="description"
    content="Dota 2 Helper — квизы и помощь по позициям и выбору героев."
  />
  <style>
    :root {
      --bg-main: #050509;
      --glass-bg: rgba(15, 15, 20, 0.82);
      --glass-bg-soft: rgba(18, 18, 26, 0.9);
      --accent: #ff4b8b;
      --accent-alt: #7b5cff;
      --accent-soft: rgba(255, 75, 139, 0.12);
      --accent-border: rgba(255, 75, 139, 0.5);
      --text-main: #f5f5f7;
      --text-muted: #9b9ba1;
      --text-soft: #6f6f78;
      --danger: #ff5c5c;
      --success: #3adb8b;
      --warning: #ffc857;
      --nav-height: 70px;
      --radius-lg: 24px;
      --radius-md: 18px;
      --radius-sm: 12px;
      --shadow-soft: 0 18px 45px rgba(0, 0, 0, 0.65);
      --shadow-inner: inset 0 0 0 1px rgba(255, 255, 255, 0.06);
      --transition-fast: 0.18s ease-out;
      --transition-slow: 0.35s cubic-bezier(0.19, 1, 0.22, 1);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Inter",
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #1b0b33 0, #050509 55%, #000 100%);
      color: var(--text-main);
      -webkit-font-smoothing: antialiased;
    }

    .app {
      min-height: 100vh;
      max-width: 520px;
      margin: 0 auto;
      padding: 16px 16px calc(var(--nav-height) + 20px);
      display: flex;
      flex-direction: column;
      gap: 16px;
      position: relative;
    }

    @media (min-width: 768px) {
      .app {
        padding-top: 32px;
        padding-bottom: 32px;
      }
    }

    .app::before {
      content: "";
      position: fixed;
      inset: -40%;
      background:
        radial-gradient(circle at 0% 0%, rgba(255, 75, 139, 0.14), transparent 55%),
        radial-gradient(circle at 100% 30%, rgba(123, 92, 255, 0.18), transparent 55%),
        radial-gradient(circle at 50% 100%, rgba(255, 90, 60, 0.14), transparent 55%);
      opacity: 0.9;
      pointer-events: none;
      z-index: -2;
    }

    .app::after {
      content: "";
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, rgba(15, 15, 20, 0.65), transparent);
      pointer-events: none;
      z-index: -1;
    }

    .glass-card {
      background: var(--glass-bg-soft);
      backdrop-filter: blur(20px) saturate(130%);
      -webkit-backdrop-filter: blur(20px) saturate(130%);
      border-radius: var(--radius-lg);
      border: 1px solid rgba(255, 255, 255, 0.06);
      box-shadow: var(--shadow-soft);
      position: relative;
      overflow: hidden;
    }

    .glass-card::before {
      content: "";
      position: absolute;
      inset: -1px;
      border-radius: inherit;
      background: radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.12), transparent 60%);
      mix-blend-mode: soft-light;
      opacity: 0.3;
      pointer-events: none;
    }

    .glass-card-inner {
      position: relative;
      padding: 18px 18px 18px;
      z-index: 1;
    }

    @media (min-width: 768px) {
      .glass-card-inner {
        padding: 20px 22px 20px;
      }
    }

    .app-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 4px;
    }

    .branding {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-pill {
      width: 40px;
      height: 40px;
      border-radius: 14px;
      background: radial-gradient(circle at 0 0, #ff4b8b, #7b5cff);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow:
        0 0 0 1px rgba(255, 255, 255, 0.18),
        0 10px 25px rgba(0, 0, 0, 0.65);
      position: relative;
      overflow: hidden;
    }

    .logo-pill::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 30% 0, rgba(255, 255, 255, 0.35), transparent 55%);
      mix-blend-mode: soft-light;
      opacity: 0.8;
    }

    .logo-pill span {
      position: relative;
      font-weight: 800;
      font-size: 18px;
      letter-spacing: 0.04em;
      text-shadow: 0 4px 10px rgba(0, 0, 0, 0.7);
    }

    .branding-text {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .branding-title {
      font-size: 18px;
      font-weight: 600;
      letter-spacing: 0.03em;
      text-transform: uppercase;
    }

    .branding-subtitle {
      font-size: 12px;
      color: var(--text-soft);
    }

    .tg-status {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(32, 40, 52, 0.8);
      border: 1px solid rgba(120, 140, 200, 0.35);
      box-shadow:
        0 0 0 1px rgba(0, 0, 0, 0.7),
        0 10px 30px rgba(0, 0, 0, 0.75);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
    }

    .tg-status-dot {
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: #34d399;
      box-shadow: 0 0 0 5px rgba(52, 211, 153, 0.18);
    }

    .tg-status-label {
      color: #cbd5f5;
    }

    .section-title {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .section-subtitle {
      font-size: 13px;
      color: var(--text-muted);
      margin-bottom: 14px;
    }

    .chip-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 8px;
      margin-bottom: 6px;
    }

    .chip {
      padding: 5px 10px;
      border-radius: 999px;
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      border: 1px solid rgba(255, 255, 255, 0.12);
      background: radial-gradient(circle at 0 0, rgba(255, 75, 139, 0.12), transparent 70%);
      color: #f5f5ff;
    }

    .chip-soft {
      border-radius: 999px;
      padding: 5px 9px;
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--text-soft);
      background: rgba(255, 255, 255, 0.02);
      border: 1px dashed rgba(255, 255, 255, 0.06);
    }

    .page {
      display: none;
      animation: fade-in 0.25s ease-out;
    }

    .page.active {
      display: block;
    }

    @keyframes fade-in {
      from {
        opacity: 0;
        transform: translateY(4px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .quick-actions {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
      margin-bottom: 16px;
    }

    @media (max-width: 380px) {
      .quick-actions {
        grid-template-columns: 1fr;
      }
    }

    .quick-action {
      position: relative;
      padding: 12px 12px 12px;
      border-radius: var(--radius-md);
      background: linear-gradient(
          135deg,
          rgba(255, 75, 139, 0.16),
          rgba(125, 83, 255, 0.08)
        ),
        rgba(19, 19, 26, 0.96);
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow:
        0 14px 30px rgba(0, 0, 0, 0.75),
        0 0 0 1px rgba(255, 255, 255, 0.03);
      cursor: pointer;
      overflow: hidden;
      transition: transform var(--transition-fast), box-shadow var(--transition-fast),
        border-color var(--transition-fast), background var(--transition-fast);
    }

    .quick-action::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.16), transparent 65%);
      mix-blend-mode: soft-light;
      opacity: 0.55;
      pointer-events: none;
    }

    .quick-action.locked {
      cursor: default;
      background: linear-gradient(
          135deg,
          rgba(130, 130, 140, 0.14),
          rgba(36, 36, 52, 0.1)
        ),
        rgba(12, 12, 18, 0.96);
      border-style: dashed;
    }

    .quick-action:hover:not(.locked) {
      transform: translateY(-2px);
      box-shadow:
        0 18px 40px rgba(0, 0, 0, 0.85),
        0 0 0 1px rgba(255, 255, 255, 0.06);
      border-color: rgba(255, 255, 255, 0.14);
    }

    .quick-action-main {
      display: flex;
      flex-direction: column;
      gap: 4px;
      position: relative;
      z-index: 1;
    }

    .quick-action-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: rgba(255, 255, 255, 0.62);
    }

    .quick-action-title {
      font-size: 15px;
      font-weight: 600;
      margin-bottom: 2px;
    }

    .quick-action-desc {
      font-size: 12px;
      color: var(--text-muted);
    }

    .quick-action-meta-row {
      margin-top: 8px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 6px;
    }

    .qa-badge {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      font-size: 11px;
      padding: 5px 9px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.22);
      border: 1px solid rgba(255, 255, 255, 0.08);
      color: rgba(255, 255, 255, 0.86);
    }

    .qa-badge-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--success);
      box-shadow: 0 0 0 4px rgba(58, 219, 139, 0.18);
    }

    .quick-action .qa-meta-text {
      font-size: 11px;
      color: var(--text-soft);
    }

    .quick-action.locked .qa-badge-dot {
      background: var(--warning);
      box-shadow: 0 0 0 4px rgba(255, 200, 87, 0.2);
    }

    .quick-action.locked .qa-meta-text {
      color: rgba(210, 210, 220, 0.7);
    }

    .quick-action-lock-pill {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.45);
      border: 1px solid rgba(255, 255, 255, 0.08);
      color: rgba(255, 255, 255, 0.8);
    }

    .quick-action-lock-pill svg {
      width: 11px;
      height: 11px;
      opacity: 0.85;
    }

    .tip-card {
      border-radius: var(--radius-lg);
      background: radial-gradient(circle at 0 0, rgba(255, 75, 139, 0.16), transparent 60%),
        radial-gradient(circle at 100% 100%, rgba(123, 92, 255, 0.16), transparent 62%),
        rgba(13, 13, 20, 0.96);
      border: 1px solid rgba(255, 255, 255, 0.06);
      box-shadow:
        0 16px 40px rgba(0, 0, 0, 0.85),
        0 0 0 1px rgba(255, 255, 255, 0.03);
      padding: 14px 14px 12px;
      position: relative;
      overflow: hidden;
    }

    .tip-card::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.16), transparent 65%);
      opacity: 0.7;
      mix-blend-mode: soft-light;
      pointer-events: none;
    }

    .tip-tag-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 6px;
      margin-bottom: 6px;
      position: relative;
      z-index: 1;
    }

    .tip-tag {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      padding: 4px 9px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.45);
      border: 1px solid rgba(255, 255, 255, 0.08);
      color: rgba(255, 255, 255, 0.9);
    }

    .tip-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 0 5px rgba(255, 75, 139, 0.18);
    }

    .tip-rotation-badge {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: rgba(237, 237, 245, 0.75);
      opacity: 0.9;
    }

    .tip-text {
      position: relative;
      z-index: 1;
      font-size: 13px;
      line-height: 1.55;
      color: rgba(242, 242, 250, 0.92);
      margin-bottom: 8px;
    }

    .tip-meta-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      position: relative;
      z-index: 1;
    }

    .tip-meta-left {
      font-size: 11px;
      color: rgba(210, 210, 225, 0.85);
    }

    .tip-meta-right {
      font-size: 11px;
      color: rgba(180, 180, 210, 0.85);
    }

    .quiz-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-top: 4px;
    }

    .quiz-card {
      position: relative;
      padding: 12px 12px 12px;
      border-radius: var(--radius-md);
      background: linear-gradient(
          135deg,
          rgba(255, 75, 139, 0.12),
          rgba(123, 92, 255, 0.08)
        ),
        rgba(19, 19, 26, 0.96);
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow:
        0 12px 30px rgba(0, 0, 0, 0.8),
        0 0 0 1px rgba(255, 255, 255, 0.03);
      cursor: pointer;
      overflow: hidden;
      transition: transform var(--transition-fast), box-shadow var(--transition-fast),
        border-color var(--transition-fast), background var(--transition-fast);
    }

    .quiz-card::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.18), transparent 70%);
      opacity: 0.75;
      mix-blend-mode: soft-light;
      pointer-events: none;
    }

    .quiz-card.locked {
      cursor: default;
      opacity: 0.92;
      background: linear-gradient(
          135deg,
          rgba(130, 130, 140, 0.14),
          rgba(36, 36, 52, 0.1)
        ),
        rgba(12, 12, 18, 0.96);
      border-style: dashed;
    }

    .quiz-card:hover:not(.locked) {
      transform: translateY(-2px);
      box-shadow:
        0 16px 38px rgba(0, 0, 0, 0.9),
        0 0 0 1px rgba(255, 255, 255, 0.05);
      border-color: rgba(255, 255, 255, 0.16);
    }

    .quiz-card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 6px;
    }

    .quiz-card-title {
      font-size: 14px;
      font-weight: 600;
    }

    .quiz-card-desc {
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 8px;
    }

    .quiz-meta-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      font-size: 11px;
      color: var(--text-soft);
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 11px;
      background: rgba(0, 0, 0, 0.35);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .badge-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--success);
      box-shadow: 0 0 0 4px rgba(58, 219, 139, 0.2);
    }

    .badge-locked {
      background: rgba(0, 0, 0, 0.55);
      border-style: dashed;
      color: rgba(220, 220, 230, 0.86);
    }

    .badge-locked-dot {
      background: var(--warning);
      box-shadow: 0 0 0 4px rgba(255, 200, 87, 0.28);
    }

    .last-result-card {
      margin-top: 12px;
      padding: 10px 12px;
      border-radius: var(--radius-md);
      background: rgba(0, 0, 0, 0.4);
      border: 1px dashed rgba(255, 255, 255, 0.12);
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 12px;
      color: var(--text-muted);
    }

    .last-result-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 6px;
      margin-bottom: 2px;
    }

    .last-result-title {
      font-size: 12px;
      color: rgba(230, 230, 245, 0.9);
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    .last-result-pill {
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.55);
      border: 1px solid rgba(255, 255, 255, 0.12);
      color: rgba(230, 230, 245, 0.9);
    }

    .last-result-main {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }

    .last-result-pos {
      font-weight: 600;
      font-size: 13px;
    }

    .last-result-date {
      font-size: 11px;
      color: var(--text-soft);
    }

    .quiz-screen {
      display: none;
      margin-top: 8px;
    }

    .quiz-screen.active {
      display: block;
    }

    .quiz-question-header {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-bottom: 10px;
    }

    .quiz-question-counter {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: var(--text-soft);
    }

    .quiz-question-text {
      font-size: 15px;
      font-weight: 500;
    }

    .progress-track {
      width: 100%;
      height: 7px;
      border-radius: 999px;
      background: rgba(34, 34, 48, 0.9);
      overflow: hidden;
      margin-bottom: 12px;
      box-shadow: var(--shadow-inner);
    }

    .progress-fill {
      width: 0%;
      height: 100%;
      border-radius: inherit;
      background: linear-gradient(90deg, var(--accent), var(--accent-alt));
      transition: width var(--transition-slow);
    }

    .answer-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 12px;
    }

    .answer-btn {
      width: 100%;
      border: none;
      border-radius: 14px;
      padding: 10px 11px;
      text-align: left;
      background: rgba(13, 13, 20, 0.96);
      color: var(--text-main);
      font-size: 13px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      box-shadow:
        0 10px 24px rgba(0, 0, 0, 0.8),
        0 0 0 1px rgba(255, 255, 255, 0.04);
      transition: transform var(--transition-fast), box-shadow var(--transition-fast),
        background var(--transition-fast), border-color var(--transition-fast);
      border: 1px solid rgba(255, 255, 255, 0.06);
      position: relative;
      overflow: hidden;
    }

    .answer-btn::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.12), transparent 65%);
      opacity: 0;
      mix-blend-mode: soft-light;
      transition: opacity var(--transition-fast);
      pointer-events: none;
    }

    .answer-btn:hover {
      transform: translateY(-1px);
      box-shadow:
        0 14px 30px rgba(0, 0, 0, 0.9),
        0 0 0 1px rgba(255, 255, 255, 0.08);
      border-color: rgba(255, 255, 255, 0.12);
      background: radial-gradient(circle at 0 0, rgba(255, 75, 139, 0.16), transparent 70%),
        rgba(15, 15, 24, 0.96);
    }

    .answer-btn:hover::before {
      opacity: 0.9;
    }

    .answer-label {
      flex: 1;
    }

    .answer-meta {
      font-size: 11px;
      color: var(--text-soft);
    }

    .quiz-footer-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      font-size: 11px;
      color: var(--text-soft);
    }

    .quiz-footer-hint {
      opacity: 0.8;
    }

    .quiz-footer-progress {
      font-feature-settings: "tnum" 1, "lnum" 1;
      opacity: 0.9;
    }

    .result-card {
      margin-top: 6px;
      padding: 12px 12px 10px;
      border-radius: var(--radius-md);
      background: radial-gradient(circle at 0 0, rgba(255, 75, 139, 0.16), transparent 60%),
        rgba(13, 13, 20, 0.96);
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow:
        0 14px 34px rgba(0, 0, 0, 0.9),
        0 0 0 1px rgba(255, 255, 255, 0.04);
    }

    .result-header-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 6px;
    }

    .result-main-pos {
      font-size: 14px;
      font-weight: 600;
    }

    .result-sub-pos {
      font-size: 12px;
      color: var(--text-muted);
    }

    .result-stat-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px;
      margin-top: 6px;
      margin-bottom: 6px;
    }

    .stat-item {
      padding: 6px 7px;
      border-radius: 10px;
      background: rgba(0, 0, 0, 0.45);
      border: 1px solid rgba(255, 255, 255, 0.06);
    }

    .stat-label {
      font-size: 11px;
      color: var(--text-soft);
      margin-bottom: 4px;
    }

    .stat-bar-track {
      width: 100%;
      height: 4px;
      border-radius: 999px;
      background: rgba(34, 34, 48, 0.9);
      overflow: hidden;
    }

    .stat-bar-fill {
      height: 100%;
      width: 0%;
      border-radius: inherit;
      background: linear-gradient(90deg, var(--accent), var(--accent-alt));
    }

    .result-toggle-details {
      margin-top: 8px;
      display: flex;
      justify-content: flex-end;
    }

    .toggle-btn {
      border: none;
      background: rgba(0, 0, 0, 0.4);
      color: rgba(240, 240, 255, 0.9);
      border-radius: 999px;
      padding: 5px 10px;
      font-size: 11px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      border: 1px solid rgba(255, 255, 255, 0.16);
      box-shadow:
        0 8px 20px rgba(0, 0, 0, 0.8),
        0 0 0 1px rgba(255, 255, 255, 0.05);
      transition: background var(--transition-fast), transform var(--transition-fast),
        box-shadow var(--transition-fast), border-color var(--transition-fast);
    }

    .toggle-btn:hover {
      transform: translateY(-1px);
      background: rgba(0, 0, 0, 0.6);
      border-color: rgba(255, 255, 255, 0.3);
      box-shadow:
        0 12px 26px rgba(0, 0, 0, 0.9),
        0 0 0 1px rgba(255, 255, 255, 0.08);
    }

    .toggle-icon {
      font-size: 12px;
      opacity: 0.9;
    }

    .result-details {
      margin-top: 6px;
      font-size: 12px;
      color: var(--text-muted);
      line-height: 1.55;
      display: none;
    }

    .result-details.visible {
      display: block;
    }

    .hero-quiz-screen {
      display: none;
      margin-top: 8px;
    }

    .hero-quiz-screen.active {
      display: block;
    }

    .hero-start-options {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 8px;
    }

    .hero-option-btn {
      border-radius: 14px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      background: rgba(13, 13, 20, 0.96);
      padding: 10px 11px;
      color: var(--text-main);
      font-size: 13px;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      gap: 4px;
      align-items: flex-start;
      box-shadow:
        0 10px 24px rgba(0, 0, 0, 0.85),
        0 0 0 1px rgba(255, 255, 255, 0.03);
      transition: transform var(--transition-fast), box-shadow var(--transition-fast),
        border-color var(--transition-fast), background var(--transition-fast);
      position: relative;
      overflow: hidden;
    }

    .hero-option-btn::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.14), transparent 60%);
      opacity: 0;
      mix-blend-mode: soft-light;
      pointer-events: none;
      transition: opacity var(--transition-fast);
    }

    .hero-option-btn:hover {
      transform: translateY(-1px);
      box-shadow:
        0 14px 30px rgba(0, 0, 0, 0.9),
        0 0 0 1px rgba(255, 255, 255, 0.08);
      border-color: rgba(255, 255, 255, 0.16);
      background: radial-gradient(circle at 0 0, rgba(255, 75, 139, 0.16), transparent 60%),
        rgba(15, 15, 24, 0.96);
    }

    .hero-option-btn:hover::before {
      opacity: 1;
    }

    .hero-option-label {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--text-soft);
    }

    .hero-option-title {
      font-size: 14px;
      font-weight: 500;
    }

    .hero-option-desc {
      font-size: 12px;
      color: var(--text-muted);
    }

    .hero-position-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 8px;
    }

    .hero-pos-btn {
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      background: rgba(13, 13, 20, 0.96);
      padding: 7px 11px;
      color: var(--text-main);
      font-size: 13px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      box-shadow:
        0 8px 18px rgba(0, 0, 0, 0.85),
        0 0 0 1px rgba(255, 255, 255, 0.03);
      transition: transform var(--transition-fast), box-shadow var(--transition-fast),
        border-color var(--transition-fast), background var(--transition-fast);
    }

    .hero-pos-btn:hover {
      transform: translateY(-1px);
      box-shadow:
        0 12px 24px rgba(0, 0, 0, 0.9),
        0 0 0 1px rgba(255, 255, 255, 0.08);
      border-color: rgba(255, 255, 255, 0.18);
      background: radial-gradient(circle at 0 0, rgba(123, 92, 255, 0.16), transparent 60%),
        rgba(15, 15, 24, 0.96);
    }

    .hero-pos-main {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .hero-pos-icon {
      width: 20px;
      height: 20px;
      border-radius: 7px;
      background: radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.2), transparent 70%),
        linear-gradient(135deg, #ff4b8b, #7b5cff);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: 700;
      box-shadow:
        0 8px 18px rgba(0, 0, 0, 0.85),
        0 0 0 1px rgba(255, 255, 255, 0.12);
    }

    .hero-pos-title {
      font-size: 13px;
      font-weight: 500;
    }

    .hero-pos-sub {
      font-size: 11px;
      color: var(--text-soft);
    }

    .hero-path-chip {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 11px;
      background: rgba(0, 0, 0, 0.4);
      border: 1px solid rgba(255, 255, 255, 0.12);
      color: rgba(230, 230, 245, 0.9);
    }

    .hero-result-card {
      margin-top: 10px;
      padding: 11px 12px 10px;
      border-radius: var(--radius-md);
      background: radial-gradient(circle at 0 0, rgba(255, 75, 139, 0.16), transparent 60%),
        rgba(12, 12, 18, 0.98);
      border: 1px solid rgba(255, 255, 255, 0.08);
      box-shadow:
        0 16px 40px rgba(0, 0, 0, 0.9),
        0 0 0 1px rgba(255, 255, 255, 0.04);
    }

    .hero-result-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 6px;
    }

    .hero-result-title {
      font-size: 14px;
      font-weight: 600;
    }

    .hero-result-sub {
      font-size: 12px;
      color: var(--text-muted);
    }

    .hero-list {
      margin-top: 6px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .hero-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      font-size: 13px;
      padding: 6px 8px;
      border-radius: 10px;
      background: rgba(0, 0, 0, 0.4);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .hero-name {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .hero-dot {
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: var(--accent);
      box-shadow: 0 0 0 5px rgba(255, 75, 139, 0.2);
    }

    .hero-score {
      font-size: 12px;
      color: rgba(235, 235, 250, 0.9);
    }

    .hero-desc {
      margin-top: 6px;
      font-size: 12px;
      color: var(--text-muted);
      line-height: 1.5;
    }

    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: var(--nav-height);
      display: flex;
      justify-content: center;
      pointer-events: none;
      z-index: 10;
    }

    @media (min-width: 768px) {
      .bottom-nav {
        position: sticky;
        bottom: 0;
        margin-top: auto;
      }
    }

    .bottom-nav-inner {
      pointer-events: auto;
      width: 100%;
      max-width: 520px;
      padding: 8px 16px 14px;
    }

    .bottom-nav-bg {
      border-radius: 999px;
      background: radial-gradient(circle at 0 0, rgba(255, 75, 139, 0.2), transparent 65%),
        radial-gradient(circle at 100% 100%, rgba(123, 92, 255, 0.18), transparent 65%),
        rgba(18, 18, 26, 0.98);
      border: 1px solid rgba(255, 255, 255, 0.14);
      box-shadow:
        0 -10px 45px rgba(0, 0, 0, 0.9),
        0 10px 35px rgba(0, 0, 0, 0.85),
        0 0 0 1px rgba(255, 255, 255, 0.08);
      padding: 6px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 4px;
      backdrop-filter: blur(20px) saturate(140%);
      -webkit-backdrop-filter: blur(20px) saturate(140%);
    }

    .nav-item {
      flex: 1;
      border-radius: 999px;
      padding: 6px 8px;
      border: none;
      background: transparent;
      color: var(--text-muted);
      font-size: 11px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      position: relative;
      transition: color var(--transition-fast), background var(--transition-fast),
        transform var(--transition-fast), box-shadow var(--transition-fast);
    }

    .nav-item-icon {
      font-size: 14px;
    }

    .nav-item-label {
      display: none;
    }

    @media (min-width: 400px) {
      .nav-item-label {
        display: inline;
      }
    }

    .nav-item::before {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: inherit;
      background: radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.16), transparent 60%);
      opacity: 0;
      pointer-events: none;
      transition: opacity var(--transition-fast);
    }

    .nav-item.active {
      color: #ffffff;
      background: rgba(0, 0, 0, 0.5);
      box-shadow:
        0 10px 24px rgba(0, 0, 0, 0.85),
        0 0 0 1px rgba(255, 255, 255, 0.14);
      transform: translateY(-1px);
    }

    .nav-item.active::before {
      opacity: 1;
    }

    .nav-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 0 4px rgba(255, 75, 139, 0.18);
    }

    .page-placeholder {
      font-size: 13px;
      color: var(--text-muted);
      line-height: 1.7;
    }

    .placeholder-badge {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 11px;
      background: rgba(0, 0, 0, 0.4);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: rgba(240, 240, 255, 0.9);
      margin-bottom: 8px;
    }

    .placeholder-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent);
    }

    .btn-outline {
      border-radius: 999px;
      padding: 7px 12px;
      border: 1px solid rgba(255, 255, 255, 0.16);
      background: rgba(0, 0, 0, 0.4);
      color: rgba(240, 240, 255, 0.9);
      font-size: 12px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow:
        0 8px 22px rgba(0, 0, 0, 0.85),
        0 0 0 1px rgba(255, 255, 255, 0.04);
      transition: background var(--transition-fast), transform var(--transition-fast),
        border-color var(--transition-fast), box-shadow var(--transition-fast);
    }

    .btn-outline:hover {
      background: rgba(255, 255, 255, 0.05);
      transform: translateY(-1px);
      border-color: rgba(255, 255, 255, 0.28);
      box-shadow:
        0 12px 30px rgba(0, 0, 0, 0.9),
        0 0 0 1px rgba(255, 255, 255, 0.08);
    }

    .btn-outline-icon {
      font-size: 13px;
    }

    .pill-soft {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      padding: 4px 9px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.45);
      border: 1px solid rgba(255, 255, 255, 0.12);
      color: rgba(232, 232, 248, 0.9);
    }

    .pill-soft-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 0 5px rgba(255, 75, 139, 0.2);
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="glass-card">
      <div class="glass-card-inner">
        <header class="app-header">
          <div class="branding">
            <div class="logo-pill">
              <span>D2</span>
            </div>
            <div class="branding-text">
              <div class="branding-title">Dota 2 Helper</div>
              <div class="branding-subtitle">Твой мини-коуч внутри Telegram</div>
            </div>
          </div>
          <div class="tg-status">
            <div class="tg-status-dot"></div>
            <div class="tg-status-label">Mini App активен</div>
          </div>
        </header>

        <main>
          <section id="page-dashboard" class="page active">
            <div class="chip-row">
              <span class="chip">Главная</span>
              <span class="chip-soft">Версия MVP • квиз по позициям</span>
            </div>
            <h1 class="section-title">Добро пожаловать в Dota 2 Helper</h1>
            <p class="section-subtitle">
              Узнай свой стиль игры и получи подсказки по героям и ролям.
            </p>

            <section class="quick-actions">
              <button
                type="button"
                class="quick-action"
                id="btn-open-position-quiz-from-dashboard"
              >
                <div class="quick-action-main">
                  <div class="quick-action-label">Рекомендуем начать с этого</div>
                  <div class="quick-action-title">Пройти тест по позициям</div>
                  <div class="quick-action-desc">
                    Определим, на какой роли ты раскроешься сильнее всего.
                  </div>
                  <div class="quick-action-meta-row">
                    <span class="qa-badge">
                      <span class="qa-badge-dot"></span>
                      <span>Квиз готов</span>
                    </span>
                    <span class="qa-meta-text">5 вопросов • ~3 минуты</span>
                  </div>
                </div>
              </button>

              <button type="button" class="quick-action locked">
                <div class="quick-action-main">
                  <div class="quick-action-label">В разработке</div>
                  <div class="quick-action-title">Подбор идеального героя</div>
                  <div class="quick-action-desc">
                    Ветвящийся квиз, который поможет найти героев под твой стиль.
                  </div>
                  <div class="quick-action-meta-row">
                    <span class="quick-action-lock-pill">
                      <svg viewBox="0 0 24 24" aria-hidden="true">
                        <path
                          fill="currentColor"
                          d="M17 9h-1V7a4 4 0 0 0-8 0v2H7a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-7a2 2 0 0 0-2-2Zm-7-2a2 2 0 0 1 4 0v2h-4V7Zm7 11H7v-7h10v7Z"
                        />
                      </svg>
                      Скоро
                    </span>
                    <span class="qa-meta-text">Связано с тестом по позициям</span>
                  </div>
                </div>
              </button>
            </section>

            <section class="tip-card" id="tip-card">
              <div class="tip-tag-row">
                <div class="tip-tag">
                  <span class="tip-dot"></span>
                  <span>Совет дня</span>
                </div>
                <div class="tip-rotation-badge">Ротация каждые 24 часа</div>
              </div>
              <div class="tip-text" id="tip-text">
                Начни с одной роли и доведи её до уверенного уровня. Постоянная смена
                позиций замедляет прогресс и мешает почувствовать игру.
              </div>
              <div class="tip-meta-row">
                <span class="tip-meta-left">Фокусируйся на 1–2 позициях</span>
                <span class="tip-meta-right" id="tip-meta-label">Монти, 6к MMR</span>
              </div>
            </section>
          </section>

          <section id="page-quizzes" class="page">
            <div class="chip-row">
              <span class="chip">Квизы</span>
              <span class="chip-soft">Позиции • герои • драфт</span>
            </div>
            <h2 class="section-title">Квизы по стилю игры</h2>
            <p class="section-subtitle">
              Небольшие тесты помогут лучше понять, как ты играешь, и подобрать
              героев под твой стиль.
            </p>

            <section class="quiz-list">
              <article
                class="quiz-card"
                id="quiz-card-position"
              >
                <div class="quiz-card-header">
                  <div>
                    <div class="quiz-card-title">Какая твоя позиция?</div>
                    <div class="quiz-card-desc">
                      5 вопросов, чтобы понять, где ты раскрываешься лучше всего:
                      керри, мид, оффлейн, роум или фулл-саппорт.
                    </div>
                  </div>
                  <div class="badge">
                    <span class="badge-dot"></span>
                    <span>Работает</span>
                  </div>
                </div>
                <div class="quiz-meta-row">
                  <span>• 5 вопросов • результат сразу</span>
                  <span id="quiz-position-last-label">Последний результат сохранён</span>
                </div>
              </article>

              <article class="quiz-card locked" id="quiz-card-hero">
                <div class="quiz-card-header">
                  <div>
                    <div class="quiz-card-title">Подбор идеального героя</div>
                    <div class="quiz-card-desc">
                      Ветвящийся квиз: выбираем позицию (из теста или вручную) и
                      сужаем круг до 3–5 подходящих героев.
                    </div>
                  </div>
                  <div class="badge badge-locked">
                    <span class="badge-locked-dot"></span>
                    <span>Скоро</span>
                  </div>
                </div>
                <div class="quiz-meta-row">
                  <span>• Ветвящийся сценарий • 3–4 шага</span>
                  <span>Интеграция с тестом по позициям</span>
                </div>

                <div
                  class="hero-quiz-screen"
                  id="hero-quiz-screen-preview"
                >
                  <p class="page-placeholder">
                    Здесь будет квиз по подбору героев. Сначала он спросит, хочешь ли ты
                    использовать позицию из прошедшего теста, или выбрать позицию
                    вручную:
                  </p>
                  <div class="hero-start-options">
                    <button
                      type="button"
                      class="hero-option-btn"
                      disabled
                    >
                      <div class="hero-option-label">Вариант 1</div>
                      <div class="hero-option-title">
                        Использовать позицию из теста
                      </div>
                      <div class="hero-option-desc">
                        Если ты проходил тест по позициям, мы возьмём сохранённую роль
                        и зададим только уточняющие вопросы.
                      </div>
                    </button>
                    <button
                      type="button"
                      class="hero-option-btn"
                      disabled
                    >
                      <div class="hero-option-label">Вариант 2</div>
                      <div class="hero-option-title">
                        Выбрать позицию вручную
                      </div>
                      <div class="hero-option-desc">
                        Просто выбери, для какой роли ищем героя: керри, мид, оффлейн,
                        роум или фулл-саппорт.
                      </div>
                    </button>
                  </div>
                </div>
              </article>
            </section>

            <section
              class="last-result-card"
              id="quiz-last-result-container"
              style="display: none;"
            >
              <div class="last-result-header">
                <div class="last-result-title">Последний результат по позициям</div>
                <div
                  class="last-result-pill"
                  id="last-result-pill"
                >
                  Сохранён
                </div>
              </div>
              <div class="last-result-main">
                <div>
                  <div
                    class="last-result-pos"
                    id="last-result-position"
                  >
                    —
                  </div>
                  <div
                    class="last-result-date"
                    id="last-result-date"
                  >
                    —
                  </div>
                </div>
                <button
                  type="button"
                  class="btn-outline"
                  id="btn-repeat-position-quiz"
                >
                  <span class="btn-outline-icon">↻</span>
                  <span>Пройти ещё раз</span>
                </button>
              </div>
            </section>

            <section
              class="quiz-screen"
              id="position-quiz-screen"
            >
              <div class="quiz-question-header">
                <div
                  class="quiz-question-counter"
                  id="position-quiz-counter"
                >
                  Вопрос 1 из 5
                </div>
                <div
                  class="quiz-question-text"
                  id="position-quiz-question"
                >
                </div>
              </div>
              <div class="progress-track">
                <div
                  class="progress-fill"
                  id="position-quiz-progress"
                ></div>
              </div>
              <div
                class="answer-list"
                id="position-quiz-answers"
              ></div>
              <div class="quiz-footer-row">
                <span class="quiz-footer-hint">
                  Отвечай честно — так результат будет точнее.
                </span>
                <span
                  class="quiz-footer-progress"
                  id="position-quiz-footer-progress"
                >
                  0 / 5
                </span>
              </div>
            </section>

            <section
              class="result-card"
              id="position-quiz-result"
              style="display: none;"
            >
              <div class="result-header-row">
                <div>
                  <div
                    class="result-main-pos"
                    id="result-main-position"
                  >
                  </div>
                  <div
                    class="result-sub-pos"
                    id="result-secondary-position"
                  >
                  </div>
                </div>
                <div class="pill-soft">
                  <span class="pill-soft-dot"></span>
                  <span>Сохранено</span>
                </div>
              </div>

              <div class="result-stat-grid">
                <div class="stat-item">
                  <div class="stat-label">Фарм / Макро</div>
                  <div class="stat-bar-track">
                    <div
                      class="stat-bar-fill"
                      id="stat-farm"
                    ></div>
                  </div>
                </div>
                <div class="stat-item">
                  <div class="stat-label">Драки / Инициация</div>
                  <div class="stat-bar-track">
                    <div
                      class="stat-bar-fill"
                      id="stat-fight"
                    ></div>
                  </div>
                </div>
                <div class="stat-item">
                  <div class="stat-label">Поддержка команды</div>
                  <div class="stat-bar-track">
                    <div
                      class="stat-bar-fill"
                      id="stat-support"
                    ></div>
                  </div>
                </div>
              </div>

              <div class="result-toggle-details">
                <button
                  type="button"
                  class="toggle-btn"
                  id="btn-toggle-details"
                >
                  <span class="toggle-icon">▼</span>
                  <span>Показать детали</span>
                </button>
              </div>

              <div
                class="result-details"
                id="result-details-text"
              >
              </div>
            </section>
          </section>

          <section id="page-knowledge" class="page">
            <div class="chip-row">
              <span class="chip">База знаний</span>
              <span class="chip-soft">В разработке</span>
            </div>
            <h2 class="section-title">Мета, герои и драфт</h2>
            <p class="section-subtitle">
              Здесь появятся подборки героев, синергии, контрпики и мета-отчеты по
              патчам. Всё в одном месте.
            </p>

            <p class="page-placeholder">
              <span class="placeholder-badge">
                <span class="placeholder-dot"></span>
                <span>Планируется</span>
              </span>
              В планах:
              <br />
              • топ героев патча по позициям;<br />
              • синергии героев и сильные связки;<br />
              • быстрый поиск контрпиков;<br />
              • интеграция с OpenDota / Stratz для актуальной статистики.
            </p>
          </section>

          <section id="page-profile" class="page">
            <div class="chip-row">
              <span class="chip">Профиль</span>
              <span class="chip-soft">История и прогресс</span>
            </div>
            <h2 class="section-title">Твой профиль игрока</h2>
            <p class="section-subtitle">
              В будущем здесь появится история прохождения квизов, графики прогресса и
              связка со Steam ID.
            </p>

            <p class="page-placeholder">
              <span class="placeholder-badge">
                <span class="placeholder-dot"></span>
                <span>Скоро</span>
              </span>
              В планах:
              <br />
              • история результатов квизов;<br />
              • избранные роли и герои;<br />
              • визуализация прогресса;<br />
              • привязка к Steam и автоматический анализ матчей.
            </p>
          </section>
        </main>
      </div>
    </div>
  </div>

  <nav class="bottom-nav">
    <div class="bottom-nav-inner">
      <div class="bottom-nav-bg">
        <button
          type="button"
          class="nav-item active"
          data-page="dashboard"
        >
          <span class="nav-item-icon">🏠</span>
          <span class="nav-item-label">Главная</span>
        </button>
        <button
          type="button"
          class="nav-item"
          data-page="quizzes"
        >
          <span class="nav-item-icon">🎯</span>
          <span class="nav-item-label">Квизы</span>
        </button>
        <button
          type="button"
          class="nav-item"
          data-page="knowledge"
        >
          <span class="nav-item-icon">📊</span>
          <span class="nav-item-label">База знаний</span>
        </button>
        <button
          type="button"
          class="nav-item"
          data-page="profile"
        >
          <span class="nav-item-icon">⚙️</span>
          <span class="nav-item-label">Профиль</span>
        </button>
      </div>
    </div>
  </nav>

  <script>
    (function () {
      const tg = window.Telegram && window.Telegram.WebApp ? window.Telegram.WebApp : null;

      if (tg) {
        try {
          tg.ready();
          tg.expand();
          if (tg.setHeaderColor) {
            tg.setHeaderColor("#050509");
          }
          if (tg.setBackgroundColor) {
            tg.setBackgroundColor("#050509");
          }
        } catch (e) {
          console.warn("Telegram WebApp init error:", e);
        }
      }

      const pages = {
        dashboard: document.getElementById("page-dashboard"),
        quizzes: document.getElementById("page-quizzes"),
        knowledge: document.getElementById("page-knowledge"),
        profile: document.getElementById("page-profile"),
      };

      const navButtons = Array.from(document.querySelectorAll(".nav-item"));

      function switchPage(pageName) {
        Object.keys(pages).forEach((key) => {
          if (key === pageName) {
            pages[key].classList.add("active");
          } else {
            pages[key].classList.remove("active");
          }
        });

        navButtons.forEach((btn) => {
          if (btn.dataset.page === pageName) {
            btn.classList.add("active");
          } else {
            btn.classList.remove("active");
          }
        });
      }

      navButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          const pageName = btn.dataset.page;
          switchPage(pageName);
        });
      });

      const btnOpenPositionQuizFromDashboard = document.getElementById(
        "btn-open-position-quiz-from-dashboard"
      );
      if (btnOpenPositionQuizFromDashboard) {
        btnOpenPositionQuizFromDashboard.addEventListener("click", () => {
          switchPage("quizzes");
          openPositionQuiz();
        });
      }

      const quizCardPosition = document.getElementById("quiz-card-position");
      const quizPositionLastLabel = document.getElementById(
        "quiz-position-last-label"
      );

      const positionQuizScreen = document.getElementById("position-quiz-screen");
      const positionQuizQuestionEl = document.getElementById(
        "position-quiz-question"
      );
      const positionQuizAnswersEl = document.getElementById(
        "position-quiz-answers"
      );
      const positionQuizCounterEl = document.getElementById("position-quiz-counter");
      const positionQuizProgressEl = document.getElementById(
        "position-quiz-progress"
      );
      const positionQuizFooterProgressEl = document.getElementById(
        "position-quiz-footer-progress"
      );
      const positionResultCard = document.getElementById("position-quiz-result");
      const resultMainPositionEl = document.getElementById("result-main-position");
      const resultSecondaryPositionEl = document.getElementById(
        "result-secondary-position"
      );
      const statFarmEl = document.getElementById("stat-farm");
      const statFightEl = document.getElementById("stat-fight");
      const statSupportEl = document.getElementById("stat-support");
      const btnToggleDetails = document.getElementById("btn-toggle-details");
      const resultDetailsTextEl = document.getElementById("result-details-text");

      const quizLastResultContainer = document.getElementById(
        "quiz-last-result-container"
      );
      const lastResultPositionEl = document.getElementById("last-result-position");
      const lastResultDateEl = document.getElementById("last-result-date");
      const btnRepeatPositionQuiz = document.getElementById(
        "btn-repeat-position-quiz"
      );

      const tipTextEl = document.getElementById("tip-text");
      const tipMetaLabelEl = document.getElementById("tip-meta-label");

      const QUIZ_RESULT_STORAGE_KEY = "dota2helper_lastResult";

      const quizData = [
        {
          text: "Как ты чаще всего играешь?",
          answers: [
            {
              text: "Люблю фармить и выходить в лейт, добирая свои слоты",
              scores: [2, 1, 1, 0, 0],
            },
            {
              text: "Хочу как можно чаще драться и влиять на карту",
              scores: [1, 2, 2, 2, 1],
            },
            {
              text: "Предпочитаю помогать команде и спасать тиммейтов",
              scores: [0, 1, 1, 2, 3],
            },
            {
              text: "Хочу стоять стабильную линию и обеспечивать помощь керри",
              scores: [1, 1, 3, 1, 2],
            },
          ],
        },
        {
          text: "Что тебе важнее всего во время игры?",
          answers: [
            {
              text: "Чувствовать, что я — главный источник урона",
              scores: [3, 2, 1, 0, 0],
            },
            {
              text: "Контролировать темп игры и принимать решения",
              scores: [1, 3, 2, 1, 0],
            },
            {
              text: "Открывать драки, впитывать урон и создавать пространство",
              scores: [1, 1, 3, 2, 1],
            },
            {
              text: "Обеспечивать вижен, сейвы и комфорт тиммейтам",
              scores: [0, 1, 1, 2, 3],
            },
          ],
        },
        {
          text: "Как ты относишься к риску?",
          answers: [
            {
              text: "Готов рисковать, если это может выиграть драку или игру",
              scores: [2, 3, 2, 2, 1],
            },
            {
              text: "Предпочитаю играть аккуратно и стабильно",
              scores: [1, 1, 2, 2, 3],
            },
            {
              text: "Готов рисковать, но только когда у меня есть предметы",
              scores: [3, 2, 1, 0, 0],
            },
            {
              text: "Слежу за позицией и стараюсь не фидить, но иногда иду в all-in",
              scores: [1, 2, 2, 2, 2],
            },
          ],
        },
        {
          text: "Что тебе нравится больше всего в командной игре?",
          answers: [
            {
              text: "Когда я прихожу на драку и заканчиваю начатое",
              scores: [3, 2, 1, 0, 0],
            },
            {
              text: "Когда я создаю момент (инициация/комбо), а команда добивает",
              scores: [1, 2, 3, 2, 1],
            },
            {
              text: "Когда я контролирую карту, вижен и даю сейвы",
              scores: [0, 1, 1, 2, 3],
            },
            {
              text: "Когда я всегда вовремя оказываюсь там, где нужен",
              scores: [1, 2, 2, 3, 2],
            },
          ],
        },
        {
          text: "Какую линию ты чаще всего выбираешь (по ощущениям)?",
          answers: [
            {
              text: "Легкая линия, где я могу спокойно фармить",
              scores: [3, 1, 0, 0, 0],
            },
            {
              text: "Мид — люблю соло-линии и дуэли",
              scores: [0, 3, 0, 0, 0],
            },
            {
              text: "Сложная линия — давлю или стабилизирую её",
              scores: [0, 0, 3, 1, 0],
            },
            {
              text: "Поддержка: стою с керри или бегаю по карте",
              scores: [0, 0, 0, 2, 3],
            },
          ],
        },
      ];

      const positionNames = [
        "Керри (позиция 1)",
        "Мидер (позиция 2)",
        "Хардлейнер (позиция 3)",
        "Роумер / Четвёрка (позиция 4)",
        "Фулл-саппорт (позиция 5)",
      ];
      const positionShortNames = ["Керри", "Мидер", "Хардлейнер", "Роумер", "Фулл-саппорт"];

      const positionStats = {
        "0_1": { farm: 85, fight: 60, support: 30 },
        "0_2": { farm: 70, fight: 75, support: 25 },
        "0_3": { farm: 65, fight: 80, support: 35 },
        "0_4": { farm: 55, fight: 70, support: 45 },
        "0_5": { farm: 45, fight: 55, support: 70 },

        "1_2": { farm: 75, fight: 65, support: 35 },
        "1_3": { farm: 70, fight: 72, support: 38 },
        "1_4": { farm: 60, fight: 68, support: 50 },
        "1_5": { farm: 50, fight: 58, support: 75 },

        "2_3": { farm: 60, fight: 78, support: 40 },
        "2_4": { farm: 55, fight: 72, support: 55 },
        "2_5": { farm: 45, fight: 60, support: 80 },

        "3_4": { farm: 50, fight: 70, support: 60 },
        "3_5": { farm: 40, fight: 58, support: 85 },

        "4_5": { farm: 35, fight: 50, support: 90 },

        "0_0": { farm: 85, fight: 65, support: 25 },
        "1_1": { farm: 75, fight: 70, support: 30 },
        "2_2": { farm: 65, fight: 80, support: 35 },
        "3_3": { farm: 55, fight: 68, support: 60 },
        "4_4": { farm: 45, fight: 55, support: 85 },
      };

      const positionDescriptions = {
        "0_0":
          "Ты — классический керри. Ты любишь фармить, набирать слот за слотом и выходить в пик силы ближе к мид/лейту. Когда у тебя есть предметы, ты чувствуешь уверенность и можешь решать исход игры в соло. Важно — не забывать подключаться к ключевым дракам и иногда выходить из леса чуть раньше.",
        "0_1":
          "Ты — гибрид керри и мидера. Любишь быть источником урона, но при этом часто влияешь на темп игры, подключаясь к ранним дракам. Такая роль требует хорошего понимания таймингов и чтения карты.",
        "1_1":
          "Ты — типичный мидер. Любишь стоять сложные дуэли, контролировать темп игры и быть тем самым героем, который задаёт ритм всей команде. От тебя ждут грамотных перетяжек, ранних гангов и принятия решений.",
        "1_2":
          "Ты — мидер с уклоном в оффлейн. Не боишься фронтлайнить, заходить первым и инициировать драки. Часто берёшь на себя функции инициатора и создателя пространства.",
        "2_2":
          "Ты — хардлейнер-инициатор. Любишь стоять сложную линию, терпеть давление и потом выходить в драки с ключевыми способностями. От тебя ждут хороших инициаций, frontline и создания пространства для коров.",
        "2_3":
          "Ты — игрок, который балансирует между оффлейном и роумом. Любишь быть в центре событий, помогать на линиях и инициировать драки, не забывая про давление на карте.",
        "3_3":
          "Ты — классический роум/четвёрка. Любишь бегать по карте, создавать хаос и помогать всей команде. Ты не привязан к одной линии и часто именно ты делаешь первые киллы и создаёшь преимущество.",
        "3_4":
          "Ты — переходная роль между роумом и фулл-саппортом. Можешь как активно бегать по карте, так и стоять линию и помогать керри. Гибкий и командный стиль игры.",
        "4_4":
          "Ты — фулл-саппорт до мозга костей. Любишь помогать, ставить вижен, сейвить, а не забирать ресурсы. Тебе комфортно играть в стиле <я делаю всё, чтобы коры сияли>. Очень важная и недооценённая роль.",
        "0_2":
          "Ты часто балансируешь между фармом и активной игрой. Это похоже на керри, который любит драться раньше других или мидера, который делает ставку на переход в лейт.",
        "0_3":
          "У тебя есть задатки оффлейнера: ты не боишься сложных линий и часто оказываешься впереди в драках. При этом тебе всё ещё комфортно собирать предметы и быть кором.",
        "0_4":
          "В тебе чувствуется командный игрок. Даже играя на коре, ты склонен помогать, создавать пространство и не жадничать ресурсы.",
        "0_5":
          "Ты играешь как очень командно-ориентированный керри. Любишь помогать, возвращаться на деф, сейвить тиммейтов и не палишься на фарме до последнего.",
        "1_3":
          "Ты любишь иметь влияние как мидер, но при этом не боишься заходить первым и терпеть давление как оффлейнер. Такой стиль требует хорошего тайминга и понимания рисков.",
        "1_4":
          "Ты — очень командный мидер. Любишь помогать лайнам, часто уходишь с мида ради гангов и не играешь только ради собственного фарма.",
        "1_5":
          "Ты — мидер с огромным упором на команду. Часто жертвуешь фармом ради сейвов, телепортов и помощи. Такой стиль особенно ценен в стаке.",
        "2_4":
          "Ты — инициативный игрок, который любит инициацию и поддержку одновременно. Команда может полагаться на тебя как на того, кто начинает драку и страхует.",
        "2_5":
          "Ты — очень командно-ориентированный оффлейнер. Ты не столько про эго и фарм, сколько про фронтлайн, сейвы, ауры и стабильность для команды.",
        "3_5":
          "Ты — суппорт с акцентом на активность. Любишь бегать по карте, но при этом умеешь и стоять линию, помогая керри чувствовать себя комфортно.",
        "4_5":
          "Ты — абсолютно командный игрок, который закрывает бреши и делает всё, чтобы команда могла играть. Вижен, сейвы, коммуникация — твоя сильная сторона.",
      };

      let currentQuestionIndex = 0;
      let scores = [0, 0, 0, 0, 0];

      function renderQuestion() {
        const questionData = quizData[currentQuestionIndex];
        if (!questionData) return;

        const current = currentQuestionIndex + 1;
        const total = quizData.length;

        positionQuizCounterEl.textContent = `Вопрос ${current} из ${total}`;
        positionQuizQuestionEl.textContent = questionData.text;
        positionQuizFooterProgressEl.textContent = `${current - 1} / ${total}`;

        const progressPercent = ((current - 1) / total) * 100;
        positionQuizProgressEl.style.width = `${progressPercent}%`;

        positionQuizAnswersEl.innerHTML = "";
        questionData.answers.forEach((answer, idx) => {
          const btn = document.createElement("button");
          btn.type = "button";
          btn.className = "answer-btn";
          btn.dataset.index = String(idx);

          const labelSpan = document.createElement("span");
          labelSpan.className = "answer-label";
          labelSpan.textContent = answer.text;

          btn.appendChild(labelSpan);

          const metaSpan = document.createElement("span");
          metaSpan.className = "answer-meta";
          metaSpan.textContent = "Выбрать";

          btn.appendChild(metaSpan);

          btn.addEventListener("click", () => {
            selectAnswer(idx);
          });

          positionQuizAnswersEl.appendChild(btn);
        });
      }

      function selectAnswer(answerIndex) {
        const questionData = quizData[currentQuestionIndex];
        if (!questionData) return;

        const scoresDelta = questionData.answers[answerIndex].scores;
        scores = scores.map((val, i) => val + (scoresDelta[i] || 0));

        currentQuestionIndex += 1;

        if (currentQuestionIndex >= quizData.length) {
          showResult();
        } else {
          renderQuestion();
        }
      }

      function findTopPositions(scoreArr) {
        const scored = scoreArr.map((val, index) => ({ index, score: val }));
        scored.sort((a, b) => b.score - a.score);

        const primary = scored[0];
        const secondary = scored[1];

        return {
          primaryIndex: primary.index,
          secondaryIndex: secondary.index,
        };
      }

      function showResult() {
        const total = quizData.length;
        positionQuizFooterProgressEl.textContent = `${total} / ${total}`;
        positionQuizProgressEl.style.width = "100%";

        positionQuizScreen.classList.remove("active");
        positionResultCard.style.display = "block";

        const { primaryIndex, secondaryIndex } = findTopPositions(scores);

        const primaryName = positionNames[primaryIndex];
        const secondaryName = positionNames[secondaryIndex];
        const primaryShort = positionShortNames[primaryIndex];
        const secondaryShort = positionShortNames[secondaryIndex];

        resultMainPositionEl.textContent = primaryName;
        resultSecondaryPositionEl.textContent = `Дополнительная роль: ${secondaryName}`;

        const key =
          primaryIndex <= secondaryIndex
            ? `${primaryIndex}_${secondaryIndex}`
            : `${secondaryIndex}_${primaryIndex}`;
        const stats = positionStats[key] || { farm: 60, fight: 60, support: 60 };

        statFarmEl.style.width = `${stats.farm}%`;
        statFightEl.style.width = `${stats.fight}%`;
        statSupportEl.style.width = `${stats.support}%`;

        const descKey =
          primaryIndex <= secondaryIndex
            ? `${primaryIndex}_${secondaryIndex}`
            : `${secondaryIndex}_${primaryIndex}`;
        const description =
          positionDescriptions[descKey] ||
          "У тебя довольно гибкий стиль игры, ты можешь комфортно чувствовать себя на нескольких ролях. Попробуй сфокусироваться на 1–2 из них, чтобы прокачать их глубже.";

        resultDetailsTextEl.textContent = description;

        const payload = {
          positionIndex: primaryIndex,
          position: primaryName,
          posShort: primaryShort,
          secondaryPositionIndex: secondaryIndex,
          secondaryPosition: secondaryName,
          secondaryShort: secondaryShort,
          stats,
          descKey,
          desc: description,
          date: new Date().toISOString(),
        };

        try {
          localStorage.setItem(QUIZ_RESULT_STORAGE_KEY, JSON.stringify(payload));
        } catch (e) {
          console.warn("Не удалось сохранить результат квиза:", e);
        }

        updateLastResultFromStorage();
      }

      function openPositionQuiz() {
        positionResultCard.style.display = "none";
        positionQuizScreen.classList.add("active");

        currentQuestionIndex = 0;
        scores = [0, 0, 0, 0, 0];

        renderQuestion();
      }

      if (quizCardPosition) {
        quizCardPosition.addEventListener("click", () => {
          openPositionQuiz();
        });
      }

      if (btnRepeatPositionQuiz) {
        btnRepeatPositionQuiz.addEventListener("click", () => {
          openPositionQuiz();
        });
      }

      if (btnToggleDetails) {
        btnToggleDetails.addEventListener("click", () => {
          const isVisible = resultDetailsTextEl.classList.contains("visible");
          if (isVisible) {
            resultDetailsTextEl.classList.remove("visible");
            btnToggleDetails.querySelector(".toggle-icon").textContent = "▼";
            btnToggleDetails.querySelector("span:nth-child(2)").textContent =
              "Показать детали";
          } else {
            resultDetailsTextEl.classList.add("visible");
            btnToggleDetails.querySelector(".toggle-icon").textContent = "▲";
            btnToggleDetails.querySelector("span:nth-child(2)").textContent =
              "Скрыть детали";
          }
        });
      }

      function formatDate(dateString) {
        if (!dateString) return "";
        const date = new Date(dateString);
        if (Number.isNaN(date.getTime())) return "";
        const day = String(date.getDate()).padStart(2, "0");
        const month = String(date.getMonth() + 1).padStart(2, "0");
        const year = date.getFullYear();
        const hours = String(date.getHours()).padStart(2, "0");
        const minutes = String(date.getMinutes()).padStart(2, "0");
        return `${day}.${month}.${year}, ${hours}:${minutes}`;
      }

      function updateLastResultFromStorage() {
        let saved = null;
        try {
          const stored = localStorage.getItem(QUIZ_RESULT_STORAGE_KEY);
          if (stored) {
            saved = JSON.parse(stored);
          }
        } catch (e) {
          console.warn("Не удалось прочитать сохранённый результат квиза:", e);
        }

        if (!saved || !saved.position) {
          quizPositionLastLabel.textContent = "Ещё не проходил";
          quizLastResultContainer.style.display = "none";
          return;
        }

        quizPositionLastLabel.textContent = "Последний результат сохранён";

        quizLastResultContainer.style.display = "block";
        lastResultPositionEl.textContent = saved.position;
        lastResultDateEl.textContent = formatDate(saved.date);
      }

      updateLastResultFromStorage();

      const tips = [
        {
          text: "Не пытайся играть на всех позициях сразу. Выбери 1–2 роли и героев, которые тебе нравятся, и прокачивай их осознанно.",
          meta: "Стабильность важнее количества героев",
        },
        {
          text: "Если ты играешь на керри — смотри на миникарту так же часто, как и на крипов. Потерянные герои соперника всегда означают возможный ганг.",
          meta: "Миникарта — лучший друг кор-игрока",
        },
        {
          text: "На саппорте твой нетворт — не главное. Главное — вижен, сейвы и грамотные смоки. Иногда один хороший вард решает больше, чем лишний артефакт.",
          meta: "Вижен = информация = победа",
        },
        {
          text: "Если ты мидер, твоя задача — не только выиграть линию, но и правильно использовать это преимущество: руны, ганги, контроль темпа.",
          meta: "Мидер задаёт ритм матча",
        },
        {
          text: "Хардлейнер, который умирает ради информации и кулдаунов врага, часто делает больше, чем керри, который просто фармит лес.",
          meta: "Создание пространства — ключ к победе",
        },
        {
          text: "Не бойся признавать ошибки в игре. Осознанная ошибка — это уже шаг к росту. Важно не искать виноватых, а находить, что можно улучшить самому.",
          meta: "Менталитет роста сильнее MMR",
        },
      ];

      try {
        const TIP_STORAGE_KEY = "dota2helper_tip_index";
        let tipIndex = Number.parseInt(localStorage.getItem(TIP_STORAGE_KEY) || "0", 10);
        if (Number.isNaN(tipIndex) || tipIndex < 0 || tipIndex >= tips.length) {
          tipIndex = 0;
        }

        const tip = tips[tipIndex];
        if (tip && tipTextEl && tipMetaLabelEl) {
          tipTextEl.textContent = tip.text;
          tipMetaLabelEl.textContent = tip.meta;
        }

        const now = Date.now();
        const TIP_TIMESTAMP_KEY = "dota2helper_tip_timestamp";
        const lastTs = Number.parseInt(localStorage.getItem(TIP_TIMESTAMP_KEY) || "0", 10);
        const oneDayMs = 24 * 60 * 60 * 1000;

        if (!lastTs || now - lastTs > oneDayMs) {
          const nextIndex = (tipIndex + 1) % tips.length;
          localStorage.setItem(TIP_STORAGE_KEY, String(nextIndex));
          localStorage.setItem(TIP_TIMESTAMP_KEY, String(now));
        }
      } catch (e) {
        console.warn("Не удалось работать с localStorage для советов:", e);
      }

      console.log("Dota 2 Helper инициализирован");
    })();
  </script>
</body>
</html>